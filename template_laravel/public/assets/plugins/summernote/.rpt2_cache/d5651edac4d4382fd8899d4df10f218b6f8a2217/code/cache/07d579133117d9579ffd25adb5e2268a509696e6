{"code":"import $ from 'jquery';\r\nimport dom from '../core/dom';\r\nvar Handle = /** @class */ (function () {\r\n    function Handle(context) {\r\n        var _this = this;\r\n        this.context = context;\r\n        this.$document = $(document);\r\n        this.$editingArea = context.layoutInfo.editingArea;\r\n        this.options = context.options;\r\n        this.lang = this.options.langInfo;\r\n        this.events = {\r\n            'summernote.mousedown': function (we, e) {\r\n                if (_this.update(e.target)) {\r\n                    e.preventDefault();\r\n                }\r\n            },\r\n            'summernote.keyup summernote.scroll summernote.change summernote.dialog.shown': function () {\r\n                _this.update();\r\n            },\r\n            'summernote.disable': function () {\r\n                _this.hide();\r\n            },\r\n            'summernote.codeview.toggled': function () {\r\n                _this.update();\r\n            }\r\n        };\r\n    }\r\n    Handle.prototype.initialize = function () {\r\n        var _this = this;\r\n        this.$handle = $([\r\n            '<div class=\"note-handle\">',\r\n            '<div class=\"note-control-selection\">',\r\n            '<div class=\"note-control-selection-bg\"></div>',\r\n            '<div class=\"note-control-holder note-control-nw\"></div>',\r\n            '<div class=\"note-control-holder note-control-ne\"></div>',\r\n            '<div class=\"note-control-holder note-control-sw\"></div>',\r\n            '<div class=\"',\r\n            (this.options.disableResizeImage ? 'note-control-holder' : 'note-control-sizing'),\r\n            ' note-control-se\"></div>',\r\n            (this.options.disableResizeImage ? '' : '<div class=\"note-control-selection-info\"></div>'),\r\n            '</div>',\r\n            '</div>'\r\n        ].join('')).prependTo(this.$editingArea);\r\n        this.$handle.on('mousedown', function (event) {\r\n            if (dom.isControlSizing(event.target)) {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n                var $target_1 = _this.$handle.find('.note-control-selection').data('target');\r\n                var posStart_1 = $target_1.offset();\r\n                var scrollTop_1 = _this.$document.scrollTop();\r\n                var onMouseMove_1 = function (event) {\r\n                    _this.context.invoke('editor.resizeTo', {\r\n                        x: event.clientX - posStart_1.left,\r\n                        y: event.clientY - (posStart_1.top - scrollTop_1)\r\n                    }, $target_1, !event.shiftKey);\r\n                    _this.update($target_1[0]);\r\n                };\r\n                _this.$document\r\n                    .on('mousemove', onMouseMove_1)\r\n                    .one('mouseup', function (e) {\r\n                    e.preventDefault();\r\n                    _this.$document.off('mousemove', onMouseMove_1);\r\n                    _this.context.invoke('editor.afterCommand');\r\n                });\r\n                if (!$target_1.data('ratio')) {\r\n                    $target_1.data('ratio', $target_1.height() / $target_1.width());\r\n                }\r\n            }\r\n        });\r\n        // Listen for scrolling on the handle overlay.\r\n        this.$handle.on('wheel', function (e) {\r\n            e.preventDefault();\r\n            _this.update();\r\n        });\r\n    };\r\n    Handle.prototype.destroy = function () {\r\n        this.$handle.remove();\r\n    };\r\n    Handle.prototype.update = function (target) {\r\n        if (this.context.isDisabled()) {\r\n            return false;\r\n        }\r\n        var isImage = dom.isImg(target);\r\n        var $selection = this.$handle.find('.note-control-selection');\r\n        this.context.invoke('imagePopover.update', target);\r\n        if (isImage) {\r\n            var $image = $(target);\r\n            var position = $image.position();\r\n            var pos = {\r\n                left: position.left + parseInt($image.css('marginLeft'), 10),\r\n                top: position.top + parseInt($image.css('marginTop'), 10)\r\n            };\r\n            // exclude margin\r\n            var imageSize = {\r\n                w: $image.outerWidth(false),\r\n                h: $image.outerHeight(false)\r\n            };\r\n            $selection.css({\r\n                display: 'block',\r\n                left: pos.left,\r\n                top: pos.top,\r\n                width: imageSize.w,\r\n                height: imageSize.h\r\n            }).data('target', $image); // save current image element.\r\n            var origImageObj = new Image();\r\n            origImageObj.src = $image.attr('src');\r\n            var sizingText = imageSize.w + 'x' + imageSize.h + ' (' + this.lang.image.original + ': ' + origImageObj.width + 'x' + origImageObj.height + ')';\r\n            $selection.find('.note-control-selection-info').text(sizingText);\r\n            this.context.invoke('editor.saveTarget', target);\r\n        }\r\n        else {\r\n            this.hide();\r\n        }\r\n        return isImage;\r\n    };\r\n    /**\r\n     * hide\r\n     *\r\n     * @param {jQuery} $handle\r\n     */\r\n    Handle.prototype.hide = function () {\r\n        this.context.invoke('editor.clearTarget');\r\n        this.$handle.children().hide();\r\n    };\r\n    return Handle;\r\n}());\r\nexport default Handle;\r\n//# sourceMappingURL=Handle.js.map","map":{"version":3,"file":"Handle.js","sourceRoot":"","sources":["../../src/js/base/module/Handle.js"],"names":[],"mappings":"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"}}
