{"code":"import $ from 'jquery';\r\nimport env from '../core/env';\r\nimport func from '../core/func';\r\nimport lists from '../core/lists';\r\nimport dom from '../core/dom';\r\nvar AIR_MODE_POPOVER_X_OFFSET = 20;\r\nvar AirPopover = /** @class */ (function () {\r\n    function AirPopover(context) {\r\n        var _this = this;\r\n        this.context = context;\r\n        this.ui = $.summernote.ui;\r\n        this.options = context.options;\r\n        this.events = {\r\n            'summernote.keyup summernote.mouseup summernote.scroll': function () {\r\n                _this.update();\r\n            },\r\n            'summernote.disable summernote.change summernote.dialog.shown': function () {\r\n                _this.hide();\r\n            },\r\n            'summernote.focusout': function (we, e) {\r\n                // [workaround] Firefox doesn't support relatedTarget on focusout\r\n                //  - Ignore hide action on focus out in FF.\r\n                if (env.isFF) {\r\n                    return;\r\n                }\r\n                if (!e.relatedTarget || !dom.ancestor(e.relatedTarget, func.eq(_this.$popover[0]))) {\r\n                    _this.hide();\r\n                }\r\n            }\r\n        };\r\n    }\r\n    AirPopover.prototype.shouldInitialize = function () {\r\n        return this.options.airMode && !lists.isEmpty(this.options.popover.air);\r\n    };\r\n    AirPopover.prototype.initialize = function () {\r\n        this.$popover = this.ui.popover({\r\n            className: 'note-air-popover'\r\n        }).render().appendTo(this.options.container);\r\n        var $content = this.$popover.find('.popover-content');\r\n        this.context.invoke('buttons.build', $content, this.options.popover.air);\r\n    };\r\n    AirPopover.prototype.destroy = function () {\r\n        this.$popover.remove();\r\n    };\r\n    AirPopover.prototype.update = function () {\r\n        var styleInfo = this.context.invoke('editor.currentStyle');\r\n        if (styleInfo.range && !styleInfo.range.isCollapsed()) {\r\n            var rect = lists.last(styleInfo.range.getClientRects());\r\n            if (rect) {\r\n                var bnd = func.rect2bnd(rect);\r\n                this.$popover.css({\r\n                    display: 'block',\r\n                    left: Math.max(bnd.left + bnd.width / 2, 0) - AIR_MODE_POPOVER_X_OFFSET,\r\n                    top: bnd.top + bnd.height\r\n                });\r\n                this.context.invoke('buttons.updateCurrentStyle', this.$popover);\r\n            }\r\n        }\r\n        else {\r\n            this.hide();\r\n        }\r\n    };\r\n    AirPopover.prototype.hide = function () {\r\n        this.$popover.hide();\r\n    };\r\n    return AirPopover;\r\n}());\r\nexport default AirPopover;\r\n//# sourceMappingURL=AirPopover.js.map","map":{"version":3,"file":"AirPopover.js","sourceRoot":"","sources":["../../src/js/base/module/AirPopover.js"],"names":[],"mappings":"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"}}
