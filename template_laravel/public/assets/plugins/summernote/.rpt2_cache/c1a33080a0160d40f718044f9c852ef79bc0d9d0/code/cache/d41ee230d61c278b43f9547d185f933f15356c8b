{"code":"import $ from 'jquery';\r\nimport lists from '../core/lists';\r\nimport dom from '../core/dom';\r\nvar LinkPopover = /** @class */ (function () {\r\n    function LinkPopover(context) {\r\n        var _this = this;\r\n        this.context = context;\r\n        this.ui = $.summernote.ui;\r\n        this.options = context.options;\r\n        this.events = {\r\n            'summernote.keyup summernote.mouseup summernote.change summernote.scroll': function () {\r\n                _this.update();\r\n            },\r\n            'summernote.disable summernote.dialog.shown': function () {\r\n                _this.hide();\r\n            }\r\n        };\r\n    }\r\n    LinkPopover.prototype.shouldInitialize = function () {\r\n        return !lists.isEmpty(this.options.popover.link);\r\n    };\r\n    LinkPopover.prototype.initialize = function () {\r\n        this.$popover = this.ui.popover({\r\n            className: 'note-link-popover',\r\n            callback: function ($node) {\r\n                var $content = $node.find('.popover-content,.note-popover-content');\r\n                $content.prepend('<span><a target=\"_blank\"></a>&nbsp;</span>');\r\n            }\r\n        }).render().appendTo(this.options.container);\r\n        var $content = this.$popover.find('.popover-content,.note-popover-content');\r\n        this.context.invoke('buttons.build', $content, this.options.popover.link);\r\n    };\r\n    LinkPopover.prototype.destroy = function () {\r\n        this.$popover.remove();\r\n    };\r\n    LinkPopover.prototype.update = function () {\r\n        // Prevent focusing on editable when invoke('code') is executed\r\n        if (!this.context.invoke('editor.hasFocus')) {\r\n            this.hide();\r\n            return;\r\n        }\r\n        var rng = this.context.invoke('editor.createRange');\r\n        if (rng.isCollapsed() && rng.isOnAnchor()) {\r\n            var anchor = dom.ancestor(rng.sc, dom.isAnchor);\r\n            var href = $(anchor).attr('href');\r\n            this.$popover.find('a').attr('href', href).html(href);\r\n            var pos = dom.posFromPlaceholder(anchor);\r\n            this.$popover.css({\r\n                display: 'block',\r\n                left: pos.left,\r\n                top: pos.top\r\n            });\r\n        }\r\n        else {\r\n            this.hide();\r\n        }\r\n    };\r\n    LinkPopover.prototype.hide = function () {\r\n        this.$popover.hide();\r\n    };\r\n    return LinkPopover;\r\n}());\r\nexport default LinkPopover;\r\n//# sourceMappingURL=LinkPopover.js.map","map":{"version":3,"file":"LinkPopover.js","sourceRoot":"","sources":["../../src/js/base/module/LinkPopover.js"],"names":[],"mappings":"AAAA,OAAO,CAAC,MAAM,QAAQ,CAAC;AACvB,OAAO,KAAK,MAAM,eAAe,CAAC;AAClC,OAAO,GAAG,MAAM,aAAa,CAAC;AAE9B;IACE,qBAAY,OAAO;QAAnB,iBAaC;QAZC,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QAEvB,IAAI,CAAC,EAAE,GAAG,CAAC,CAAC,UAAU,CAAC,EAAE,CAAC;QAC1B,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC;QAC/B,IAAI,CAAC,MAAM,GAAG;YACZ,yEAAyE,EAAE;gBACzE,KAAI,CAAC,MAAM,EAAE,CAAC;YAChB,CAAC;YACD,4CAA4C,EAAE;gBAC5C,KAAI,CAAC,IAAI,EAAE,CAAC;YACd,CAAC;SACF,CAAC;IACJ,CAAC;IAED,sCAAgB,GAAhB;QACE,MAAM,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;IACnD,CAAC;IAED,gCAAU,GAAV;QACE,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC;YAC9B,SAAS,EAAE,mBAAmB;YAC9B,QAAQ,EAAE,UAAC,KAAK;gBACd,IAAM,QAAQ,GAAG,KAAK,CAAC,IAAI,CAAC,wCAAwC,CAAC,CAAC;gBACtE,QAAQ,CAAC,OAAO,CAAC,4CAA4C,CAAC,CAAC;YACjE,CAAC;SACF,CAAC,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;QAC7C,IAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,wCAAwC,CAAC,CAAC;QAE9E,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,eAAe,EAAE,QAAQ,EAAE,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;IAC5E,CAAC;IAED,6BAAO,GAAP;QACE,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;IACzB,CAAC;IAED,4BAAM,GAAN;QACE,+DAA+D;QAC/D,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC;YAC5C,IAAI,CAAC,IAAI,EAAE,CAAC;YACZ,MAAM,CAAC;QACT,CAAC;QAED,IAAM,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,oBAAoB,CAAC,CAAC;QACtD,EAAE,CAAC,CAAC,GAAG,CAAC,WAAW,EAAE,IAAI,GAAG,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;YAC1C,IAAM,MAAM,GAAG,GAAG,CAAC,QAAQ,CAAC,GAAG,CAAC,EAAE,EAAE,GAAG,CAAC,QAAQ,CAAC,CAAC;YAClD,IAAM,IAAI,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YACpC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAEtD,IAAM,GAAG,GAAG,GAAG,CAAC,kBAAkB,CAAC,MAAM,CAAC,CAAC;YAC3C,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC;gBAChB,OAAO,EAAE,OAAO;gBAChB,IAAI,EAAE,GAAG,CAAC,IAAI;gBACd,GAAG,EAAE,GAAG,CAAC,GAAG;aACb,CAAC,CAAC;QACL,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,IAAI,CAAC,IAAI,EAAE,CAAC;QACd,CAAC;IACH,CAAC;IAED,0BAAI,GAAJ;QACE,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;IACvB,CAAC;IACH,kBAAC;AAAD,CAAC,AAhED,IAgEC"}}
